<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="UTF-8">
    <title>mGame游戏社区——主页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="icon" th:href="@{/img/sys/game.ico}" type="image/x-icon">
    <link rel="shortcut icon" th:href="@{/img/sys/game.ico}" type="image/x-icon">

    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" />
    <link rel="stylesheet" th:href="@{/css/home/bootstrap.min.css}" />
    <link rel="stylesheet" th:href="@{/css/home/mgame.css}" />
    <link rel="stylesheet" th:href="@{/css/home/templatemo-style.css}" />
    <link rel="stylesheet" th:href="@{/css/home/global.css}" />
    <link rel="stylesheet" th:href="@{/style/template.css}" />
    <link rel="stylesheet" th:href="@{/style/admin.css}" />
<!--    <style>
        html{
            -webkit-filter: grayscale(100%);
            -moz-filter: grayscale(100%);
            -ms-filter: grayscale(100%);
            -o-filter: grayscale(100%);
            filter: grayscale(100%);
            filter: gray;
        }
    </style>-->
    <style>
        .mini-list li{
            text-align: center;
            font-size: 13px;
            padding-bottom: 15px;
        }
    </style>
</head>
<body style="background: #ffffff;">
<div class="layui-row layui-col-space15">
    <div th:include="/home/common/header :: header" ></div>
</div>

<div class="layui-container" >
    <div class="layui-row layui-col-space15">

        <div class="layui-col-md8 layui-col-sm10 layui-xs10">
            <div class="layui-row">
                <div class="container-fluid">
                    <div class="row">
                        <div class="layui-carousel" id="test1">
                            <div carousel-item>
                                <div th:each="at:${top}">
                                    <div>
                                        <a th:href="@{'/article/detail/'+${at.id}}">
                                            <img th:src="${at.img}" width="100%" height="100%">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-card"  style="margin-bottom: 15px">
                <div class="layui-card-header">
                    资讯<span class="layui-layout-right" style="right: 5px" ><a href="/article/list">查阅更多</a> </span>
                </div>
                <div class="layui-card-body">
                    <ul class="mgame-article">
                        <li class="mgame-article-li-white-bac" th:each="a:${article}">
                            <a target="_blank" th:href="@{'/article/detail/'+${a.id}}" class="mgame-article-avatar"><img th:src="${a.img}" alt=""></a>
                            <h2><a target="_blank" th:href="@{'/article/detail/'+${a.id}}" th:text="${a.title}"></a></h2>
                            <div class="mgame-article-info">
                                <span th:text="${a.intro}"></span>
                                <span class="mgame-article-nums" style="color: #000000">
                                    <i class="layui-icon layui-icon-date" th:text="${#dates.format(a.time, 'yyyy-MM-dd')}"></i></span>
                                </span>
                                <span class="mgame-article-tag" style="color: red">
                                    <a th:href="@{'/article/detail/'+${a.id}}">查看详情</a>
                                    <i class="layui-icon layui-icon-right" ></i>
                                </span>
                                <span class="mgame-article-msg" style="color: #000000"></span>
                            </div>
                        </li>

                    </ul>
                </div>
            </div>
            </div>
        </div>
        <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
            <div class="layui-card"  style="margin-bottom: 15px">
                <div class="layui-card-header">
                    新出板块<span class="layui-layout-right" style="right: 5px" ><a href="/bbs/mlist">查阅更多</a> </span>
                </div>
                <div class="layui-card-body">
                    <div class="layui-row layui-col-space10">
                        <div class="layui-col-md3 layui-col-sm3 layui-col-xs3" th:each="m:${module}">
                            <div class="cmdlist-container">
                                <a href="javascript:;"><img th:src="${m.photo}"></a>
                                <a href="javascript:;">
                                    <div class="cmdlist-text">
                                        <i class="miniinfo" th:text="${m.name}"></i>
                                        <div class="mes">
                                           <!-- <div class="layui-row">
                                                贴数:<span>123万</span>
                                            </div>-->
                                            <div class="layui-row">

                                                <a target="_blank" th:href="@{'/bbs/one/'+${m.id}}" class="layui-btn  layui-btn-xs minihrefin layui-btn-fluid">进入</a>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card"  style="margin-bottom: 15px">
                <div class="layui-card-header">
                    热帖推荐
                </div>
                <div class="layui-card-body">

                    <ul class="mgame-mini-article">
                        <li th:each="topic:${hotTopicRanking}">
                            <a target="_blank" th:href="@{'/bbs/one/topic/'+${topic.id}}" class="fly-avatar"><img th:src="${topic.userImg}" alt=""></a>
                            <h2><a target="_blank" th:href="@{'/bbs/one/topic/'+${topic.id}}" th:text="${topic.title}"></a></h2>
                            <div class="fly-list-info">
                                <span class="mgame-article-mini-info"><i class="layui-icon layui-icon-date" th:text="${#dates.format(topic.createTime, 'yyyy-MM-dd HH:mm:ss')}"></i></span>
                            </div>
                        </li>

                    </ul>
                </div>
            </div>

        </div>
    </div>

    <div class="layui-row">
        <div class="layui-card">
            <div class="layui-card-header">视频评测</div>
            <div class="layui-card-body">
                <div class="layui-col-md4 layui-col-sm6 layui-col-xs12" th:each="c:${video}">
                    <div class="layui-col-space15" style="height: 200px;margin: 15px">
                        <a target="_blank" th:href="@{'/article/video/detail/'+${c.id}}"><img th:src="${c.img}" width="100%" height="200px" /></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="layui-row">
            <div class="fly-panel fly-link">
                <h3 class="fly-panel-title">友情链接</h3>
                <dl class="fly-panel-main">
                    <dd th:each="url:${url}">
                        <a th:href="${url.url}" th:text="${url.name}" target="_blank"></a>
                    <dd>
                </dl>
            </div>
        </div>
</div>
    <!--尾部-->
<div th:include="/home/common/footer :: footer" ></div>

<script type="text/javascript" th:src="@{/layui/layui.js}" ></script>

<script>
    layui.config({
        base: '../../' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['flow','element','carousel','form','util'], function(){
        var element = layui.element;
        var form = layui.form;
        var util = layui.util;
        var flow = layui.flow,
            $ = layui.jquery;

        var carousel = layui.carousel;
        //建造实例
        carousel.render({
            elem: '#test1'
            ,width: '100%' //设置容器宽度
            ,arrow: 'always' //始终显示箭头
            //,anim: 'updown' //切换动画方式
        });

        //流加载图片
        var imgNums = 10;  //单页显示图片数量

        flow.load({
            elem: '#newList' //指定列表容器
            ,done: function(page, next){ //到达临界点（默认滚动触发），触发下一页
                var lis = [];

                //以jQuery的Ajax请求为例，请求下一页数据（注意：page是从2开始返回）
                $.get('/api/article/roll?page='+page+ '&limit=10', function(res){
                    //假设你的列表返回在data集合中
                    layui.each(res.data.list, function(index, item){
                        lis.push(
                            '<li class="mgame-article-li-white-bac">'+
                            '<a href='+'\"/bbs/home/id/'+'\"+item.id+'+' class="fly-avatar">'+'<img src=\"'+item.img+'\"'+' alt=\"'+item.id+'\"></a>'
                            +'<h2><a href='+'\"/article/detail?id='+item.id+'\"+' +'title="">'+item.title+'</a></h2>'
                            + '<div class="fly-list-info"> <span class="mgame-article-mini-info"><i class="layui-icon layui-icon-date"></i>'+item.time+'</span>'
                            +'</div>'
                            +'</li>'
                        );
                    });

                    //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                    //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                    next(lis.join(''), page < res.count/10);
                });
            }
        });

        /* //图片懒加载
         flow.lazyimg(options);*/
        util.fixbar({});
    });
</script>

</body>
</html>